# abfe.in

#############################################################################################################
########## Input file for BAT.py, for fully automated absolute binding free energy calculations ##########
#############################################################################################################


# Calculation definitions

# Molecules other than receptor and ligand 
#other_mol = [ ]     # List of extra residues names that will be included in the simulations

solv_shell = 15      # Water molecules around the protein that will be kept in the initial structure (in angstroms)

# Variables for setting up equilibrium and free energy calculations, also used on analysis       

# For abfe, it's express
# For rbfe, it's relative
fe_type = uno_rest  # Type of free energy calculations (rest, dd, sdr, dd-rest, sdr-rest, custom, relative)
remd = no
release_eq = [ 10.0 2.5 0.5 0.0 0.0 0.0 0.0 ]   # Equilibrium gradual release weights

# 16 short attach/release weights for the DD and SDR calculations
# it will create 16 windows
# maybe it can be less
attach_rest = [ 0.00 0.10 0.24 0.56 1.33 3.16 7.50 10.50 17.78 20.00 42.17 50.00 60.00 75.00 80.00 100.0 ]   # Short attach/release weights

# 24 lambda for MBAR calculations
# it will create 24 windows
# maybe it can be less
lambdas = [0.0 0.10565 0.14832 0.17842 0.20427 0.22603 0.24433 0.2625 0.27917 0.29575 0.31188 0.32772 0.34359 0.35892 0.37497 0.39086 0.40584 0.42001 0.43453 0.45056 0.46585 0.47913 0.49085 0.5015 0.51177 0.52289 0.53652 0.55271 0.56723 0.58061 0.59453 0.60923 0.62468 0.63991 0.65631 0.67222 0.68487 0.69656 0.70897 0.72458 0.74158 0.75893 0.779 0.79905 0.82704 0.85882 0.9069 1.0] # MBAR

# The distance of the ligand in the bulk solvent to the center of protein.
sdr_dist = 50.00

# Additional variables for analysis 

dec_int = mbar # Integration method for double decoupling (MBAR or TI with Gaussian quadrature)
blocks = 5 # Number of blocks for block data analysis

# Force constants

rec_dihcf_force      =  50.0  # Protein conformational dihedral spring constant - kcal/mol/rad**2
rec_discf_force      =     0  # Protein conformational distance spring constant - kcal/mol/Angstrom**2
lig_distance_force   =   5.0  # Guest pulling distance spring constant kcal/mol/Angstrom**2
lig_angle_force      = 250.0  # Guest angle/dihedral spring constant - kcal/mol/rad**2
lig_dihcf_force      =   0.0  # Guest conformational dihedral spring constant - kcal/mol/rad**2
rec_com_force        =  10.0  # Protein COM spring constant
lig_com_force        =  10.0  # Guest COM spring constant for simultaneous decoupling

# Water model, number and box size in the x and y direction

water_model     = TIP3P   # Water model (SPCE, TIP4PEW, TIP3P, TIP3PF or OPC)
buffer_x        = 12      # Box solvation buffer in the x axis
buffer_y        = 12      # Box solvation buffer in the y axis 
# buffer_z        = 22      # Box solvation buffer in the z axis 
lig_buffer      = 15      # Buffer size for the three axes of the ligand-only box

# Counterions 

neutralize_only = no     # neutralize only or also ionize (yes or no)
cation = Na+             # cation for neutralization/ionization                
anion = Cl-              # anion  for neutralization/ionization   
ion_conc = 0.15          # salt concentration for all boxes

# Simulation parameters

hmr             =  yes       # Use hydrogen mass repartitioning (yes or no)

Temperature	=  310    # Temperature of simulation and analysis 

eq_steps1	=   500000    # Number of steps for equilibration gradual release 
eq_steps2	=   1000000   # Number of steps for equilibration after release

e_steps1	=   50000    # Number of steps per window for component e (equilibrium) 
e_steps2	=  1500000    # Number of steps per window for component e (production)     

v_steps1	=   50000    # Number of steps per window for component v (equilibrium) 
v_steps2	=  1500000    # Number of steps per window for component v (production)  

x_steps1	=   50000    # Number of steps per window for component m (equilibrium)
x_steps2	=  1500000    # Number of steps per window for component m (production)

n_steps1	=   50000    # Number of steps per window for component n (equilibrium)
n_steps2	=  3000000    # Number of steps per window for component n (production)

m_steps1	=   50000    # Number of steps per window for component m (equilibrium)
m_steps2	=  3000000    # Number of steps per window for component m (production)

z_steps1   =   50000
z_steps2   =   300000

# The other components are not tested and used
a_steps1	=  100000    # Number of steps per window for component a (equilibrium)
a_steps2	=  200000    # Number of steps per window for component a (production) 

l_steps1	=  100000    # Number of steps per window for component l (equilibrium)  
l_steps2	=  200000    # Number of steps per window for component l (production)             

t_steps1	=  100000    # Number of steps per window for component t (equilibrium)
t_steps2	=  200000    # Number of steps per window for component t (production)     

c_steps1	=  100000    # Number of steps per window for component c (equilibrium)
c_steps2	=  200000    # Number of steps per window for component c (production)     

r_steps1	=  100000    # Number of steps per window for component r (equilibrium) 
r_steps2	=  200000    # Number of steps per window for component r (production)     
   
w_steps1	=  100000    # Number of steps per window for component w (equilibrium) 
w_steps2	=  200000    # Number of steps per window for component w (production)     

f_steps1	=  100000    # Number of steps per window for component f (equilibrium) 
f_steps2	=  200000    # Number of steps per window for component f (production)     


# Conformational restraints on the protein backbone (not tested!!!)
rec_bb		= no       # Use protein backbone dihedrals conformational restraints
bb_start        = 379       # First residues of the restrained ranges
bb_end          = 390       # Last residues of the restrained ranges
bb_equil        = yes       # Keep this backbone section rigid during equilibration 

# Ligand anchor search definitions
# changed accordingly 

l1_range        =  6.00     # search radius for the first ligand anchor L1 
min_adis        =  3.00     # minimum distance between anchors
max_adis        =  7.00     # maximum distance between anchors

# Amber options for production simulations

ntpr = 1000                # print energy every ntpr steps to output file (controls DD output)
ntwr = 10000               # write the restart file every ntwr steps
ntwe = 0                   # write energies and temperatures to mden file every ntwe steps (0 = not write to this file)
ntwx = 10000               # write coordinates to trajectory file every ntwx steps (controls PMF and restraints output)
cut = 9.0                  # cutoff for nonbonded interactions 
gamma_ln = 1.0             # collision frequency in ps^-1 for Langevin Dynamics (temperature control)
barostat = 1               # type of barostat to keep the pressure constant (1 = Berendsen-default /2 - Monte Carlo)
dt = 0.004                 # simulation time step in ps